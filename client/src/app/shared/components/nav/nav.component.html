<header
  class="fixed top-0 left-0 w-full z-40 bg-gradient-to-r from-secondary to-black text-white shadow-md"
>
  <div class="navbar">
    <div class="navbar-start flex items-center gap-3 px-4">
      @if (isLoggedIn()) {
        <button
          (click)="toggleSidebar()"
          class="btn btn-ghost btn-sm text-white hover:bg-white/10"
          aria-label="Toggle sidebar"
        >
          <lucide-icon [name]="menuIcon" class="size-6" />
        </button>
      }
      <a routerLink="/home" class="flex items-center gap-2">
        <lucide-icon [name]="usersIcon" class="size-6" />
        <h2 class="text-xl font-bold">DatingApp</h2>
      </a>
    </div>
    <div class="navbar-end flex items-center gap-2 px-4">
      @if (isLoggedIn()) {
        <!-- Logged in: Show search and notification icons -->
        <button
          class="btn btn-ghost btn-sm text-white hover:bg-white/10"
          aria-label="Search"
        >
          <lucide-icon [name]="searchIcon" class="size-6" />
        </button>
        <button
          class="btn btn-ghost btn-sm text-white hover:bg-white/10"
          aria-label="Notifications"
        >
          <lucide-icon [name]="bellIcon" class="size-6" />
        </button>
      } @else {
        <app-button
          label="Login"
          color="neutral"
          size="sm"
          [routerLink]="'/auth/login'"
        >
          <ng-container icon>
            <lucide-icon [name]="loginIcon" class="size-4" />
          </ng-container>
        </app-button>
        <app-button
          label="Register"
          color="secondary"
          size="sm"
          [routerLink]="'/auth/register'"
        >
          <ng-container icon>
            <lucide-icon [name]="registerIcon" class="size-4" />
          </ng-container>
        </app-button>
      }
    </div>
  </div>
</header>

<!-- Sidebar -->
@if (isLoggedIn()) {
  <aside
    #sidebar
    class="fixed top-0 left-0 h-full w-64 bg-gradient-to-b from-secondary to-black text-white shadow-lg z-50 transform transition-transform duration-300 ease-in-out"
    [class.translate-x-0]="sidebarOpen()"
    [class.-translate-x-full]="!sidebarOpen()"
  >
    <!-- Header -->
    <div class="flex items-center justify-between p-4 border-b border-white/10">
      <div class="flex items-center gap-3 px-2">
        <button
          (click)="toggleSidebar()"
          class="btn btn-ghost btn-sm text-white hover:bg-white/10"
          aria-label="Close sidebar"
        >
          <lucide-icon [name]="menuIcon" class="size-6" />
        </button>
        <a
          routerLink="/home"
          (click)="closeSidebar()"
          class="flex items-center gap-2"
        >
          <lucide-icon [name]="usersIcon" class="size-6" />
          <h2 class="text-xl font-bold">DatingApp</h2>
        </a>
      </div>
    </div>

    <div class="p-2 border-b border-white/10">
      <a
        routerLink="/profile/me"
        routerLinkActive="bg-white/70 text-black"
        (click)="closeSidebar()"
        class="flex items-center gap-3 hover:bg-white/10 p-2 rounded-lg transition-colors"
      >
        @if (user()?.memberDetails?.imageUrl) {
          <img
            [src]="user()?.memberDetails?.imageUrl"
            alt="User Avatar"
            class="w-10 h-10 rounded-full object-cover"
          />
        } @else {
          <ngx-avatar [name]="user()?.displayName" size="40" [round]="true" />
        }
        <span class="font-semibold">{{ user()?.displayName }}</span>
      </a>
    </div>

    <!-- Navigation Links -->
    <nav class="flex-1 overflow-y-auto py-4">
      <ul class="menu p-0 w-full">
        @for (link of navigationLinks; track link.routerLink) {
          <li>
            <a
              [routerLink]="link.routerLink"
              routerLinkActive="bg-white/70 text-black"
              (click)="closeSidebar()"
              class="flex items-center gap-3 hover:bg-white/10 font-semibold"
            >
              <lucide-icon [name]="link.icon" class="size-5" />
              <span>{{ link.label }}</span>
            </a>
          </li>
        }
        <li>
          <a
            *appHasRole="['Admin', 'Moderator']"
            routerLink="/admin/dashboard"
            routerLinkActive="bg-white/70 text-black"
            (click)="closeSidebar()"
            class="flex items-center gap-3 hover:bg-white/10 font-semibold"
          >
            <lucide-icon [name]="adminIcon" class="size-5" />
            <span>Admin</span>
          </a>
        </li>
        <li>
          <a
            (click)="logoutAlert.fire(); closeSidebar()"
            class="flex items-center gap-3 hover:bg-red-700/70 font-semibold text-red-400 hover:text-red-300"
          >
            <lucide-icon [name]="logoutIcon" class="size-5" />
            <span>Logout</span>
          </a>
        </li>
      </ul>
    </nav>
  </aside>
}

<!-- Logout Confirmation -->
<swal
  #logoutAlert
  title="Confirm logout?"
  text="When confirmed you will be logged out"
  icon="question"
  [showCancelButton]="true"
  [focusCancel]="true"
  (confirm)="onLogout()"
/>
